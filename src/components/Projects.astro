---
import { Image } from "astro:assets";

const COUNTER = 0;

const featureProjects = [
  "m8mz/discord-evil-bot",
  "m8mz/dotfiles",
  "m8mz/evilist",
];

const res = await fetch("https://api.github.com/users/m8mz/repos", {
  method: "GET",
  headers: {
    Accept: "application/vnd.github+json",
    "X-Github-Api-Version": "2022-11-28",
  },
  redirect: "follow",
});
if (!res.ok) {
  throw new Error(`Github API error: ${res.status}`);
}
const repos = await res.json();
var repositories = new Map();

// start counter at 2 to manually set first 3
const counter = 2;
for (const repo of repos) {
  if (repo.full_name === featureProjects[0]) {
    repositories.set(0, repo);
    continue;
  }
  if (repo.full_name === featureProjects[1]) {
    repositories.set(1, repo);
    continue;
  }
  if (repo.full_name === featureProjects[2]) {
    repositories.set(2, repo);
    continue;
  }
  console.log(repo.full_name);
}
console.log(repositories.size);

const projects = [
  {
    name: "discord-evil-bot",
    link: "https://github.com/m8mz/discord-evil-bot",
    description: "",
  },
  {
    name: "evilist",
    link: "https://github.com/m8mz/evilist",
    description: "",
  },
  {
    name: "dotfiles",
    link: "https://github.com/m8mz/dotfiles",
    description: "",
  },
  {
    name: "Project A",
    link: "https://github.com/m8mz/project-a",
    description: "",
  },
  {
    name: "Project B",
    link: "https://github.com/m8mz/project-b",
    description: "",
  },
  {
    name: "Project C",
    link: "https://github.com/m8mz/project-c",
    description: "",
  },
];
---

<style>
  .projects-grid {
    display: grid;
    gap: 0.5rem;
    width: 100%;
    grid-template-columns: repeat(10, 1fr);
    grid-template-rows: repeat(2, 200px);
  }

  @media (max-width: 800px) {
    .projects-grid {
      text-align: center;
      grid-template-columns: repeat(1, 1fr);
      grid-template-rows: repeat(4, auto);
    }
  }

  @media (min-width: 800px) {
    #project1 {
      grid-row: 1;
      grid-column: 1 / 5;
    }
    #project2 {
      grid-row: 1;
      grid-column: 5 / 7;
    }
    #project3 {
      grid-row: 1;
      grid-column: 7 / 11;
    }
    #project4 {
      grid-row: 2;
      grid-column: 1 / 3;
    }
    #project5 {
      grid-row: 2;
      grid-column: 3 / 5;
    }
    #project6 {
      grid-row: 2;
      grid-column: 5 / 7;
    }
    #project7 {
      grid-row: 2;
      grid-column: 7 / 9;
    }
    #project8 {
      grid-row: 2;
      grid-column: 9 / 11;
    }
  }

  .project-card {
    height: 200px;
    overflow: hidden;
    background: var(--color-brand-900);
    padding: 1.25rem;
    border-radius: var(--radius);
    display: flex;
    flex-direction: column;
  }

  .project-card h3 {
    height: 30%;
  }
  .project-card p {
    height: 50%;
    text-overflow: ellipsis;
  }
  h2 {
    color: var(--color-brand-50);
    font-size: 2.5rem;
    font-weight: 600;
    margin: 1.5rem 0;
  }
</style>
<section id="work" class="projects section-pad">
  <h2 class="text-2xl text-center">projects</h2>
  <div class="projects-grid">
    <article id="project1" class="project-card w-full">
      <h3>Project 1</h3>
      <p>Short blurb describing the tech stack and goal.</p>
      <a href="https://github.com" class="btn sm">View repo</a>
    </article>
    <article id="project2" class="project-card w-full">
      <h3>Project 1</h3>
      <p>Short blurb describing the tech stack and goal.</p>
      <a href="https://github.com" class="btn sm">View repo</a>
    </article>
    <article id="project3" class="project-card w-full">
      <h3>Project 1</h3>
      <p>Short blurb describing the tech stack and goal.</p>
      <a href="https://github.com" class="btn sm">View repo</a>
    </article>
    <article id="project4" class="project-card w-full">
      <h3>Project 1</h3>
      <p>Short blurb describing the tech stack and goal.</p>
      <a href="https://github.com" class="btn sm">View repo</a>
    </article>
    <article id="project5" class="project-card w-full">
      <h3>Project 1</h3>
      <p>Short blurb describing the tech stack and goal.</p>
      <a href="https://github.com" class="btn sm">View repo</a>
    </article>
    <article id="project6" class="project-card w-full">
      <h3>Project 1</h3>
      <p>Short blurb describing the tech stack and goal.</p>
      <a href="https://github.com" class="btn sm">View repo</a>
    </article>
    <article id="project7" class="project-card w-full">
      <h3>Project 1</h3>
      <p>Short blurb describing the tech stack and goal.</p>
      <a href="https://github.com" class="btn sm">View repo</a>
    </article>
    <article id="project8" class="project-card w-full">
      <h3>Project 1</h3>
      <p>Short blurb describing the tech stack and goal.</p>
      <a href="https://github.com" class="btn sm">View repo</a>
    </article>
  </div>
</section>
